/*!
 
 (c) 2022 impleCode - https://implecode.com
 */
function ic_register_block(Qe,e,r){const Fe=window.wp.blocks;const t=window.wp.blockEditor;const a=window.wp.element;const l=window.wp.components;const Le=window.wp.serverSideRender;const Me=window.wp.htmlEntities.decodeEntities;var De=a.createElement;var ze=t.InspectorControls;var Ue=l.SelectControl;var qe=l.TextControl;var Ge=l.RadioControl;var He=l.Spinner;var Je=l.Notice;var Ke=l.ToggleControl;var Ve=l.CheckboxControl;var We=l.SearchControl;var Xe=t.MediaPlaceholder;var Ye=l.Panel;var Ze=l.PanelBody;var $e=l.PanelRow;var et=t.AlignmentToolbar;var tt=l.ToolbarButton;var rt=t.BlockControls;var at=t.useBlockProps;var lt=a.useState;var st=[];var ot=Qe.split("/");ot=ot[1];var s={};if(r!==undefined){s.from=[{type:"block",blocks:["core/legacy-widget"],isMatch:({idBase:e,instance:t})=>{if(t.raw===undefined){return false}return e===r},transform:({instance:e})=>{return Fe.createBlock(Qe,e.raw)}}]}Fe.registerBlockType(Qe,{transforms:s,usesContext:e,edit:function(s){const o=s.attributes;const e=Fe.getBlockSupport(Qe,"ic_fields");const[i,n]=lt(false);function t(e){s.setAttributes({title:e})}function r(e){s.setAttributes({shortcode_support:e})}function a(e){s.setAttributes({dropdown:e})}function l(e){s.setAttributes({count:e})}function c(e){s.setAttributes({hierarchical:e})}function d(e,t,r){if(Array.isArray(o.selectedCategory)){if(t!==undefined){var a=false;var l=ct(o);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedCategory:l})}if(o.category.length){s.setAttributes({category:[]})}if(l.length&&o.selectedProduct!==undefined&&o.selectedProduct.length){s.setAttributes({selectedProduct:[]})}}else{s.setAttributes({category:e})}}else{s.setAttributes({category:e})}}function u(e){s.setAttributes({orderby:e})}function p(e){s.setAttributes({order:e})}function f(e){s.setAttributes({archive_template:e})}function g(e){s.setAttributes({per_row:e})}function _(e){s.setAttributes({products_limit:e})}function b(e){s.setAttributes({no_add_to_cart:e})}function h(e,t,r){if(Array.isArray(o.selectedProduct)){if(t!==undefined){var a=false;var l=nt(o);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedProduct:l})}if(o.product!==undefined&&o.product.length){s.setAttributes({product:[]})}if(l.length&&o.selectedCategory!==undefined&&o.selectedCategory.length){s.setAttributes({selectedCategory:[]})}}}else{s.setAttributes({selectedProduct:parseInt(e,10)});if(i){n(false)}}}function y(e){s.setAttributes({alignment:e===undefined?"none":e})}function v(e){s.setAttributes({productSearch:e===undefined?"":e})}function k(e){s.setAttributes({categorySearch:e===undefined?"":e})}function m(e){s.setAttributes({productFromContext:e});if(e){if(o.product!==undefined&&o.product.length){s.setAttributes({product:[]})}if(o.category!==undefined&&o.category.length){s.setAttributes({product:[]})}if(o.selectedCategory!==undefined&&o.selectedCategory.length){s.setAttributes({selectedCategory:[]})}if(o.selectedProduct!==undefined){if(Array.isArray(o.selectedProduct)&&o.selectedProduct.length){s.setAttributes({selectedProduct:[]})}else{s.setAttributes({selectedProduct:0})}}if(o.categorySearch!==undefined&&o.categorySearch.length){s.setAttributes({categorySearch:""})}if(o.productSearch!==undefined&&o.productSearch.length){s.setAttributes({productSearch:""})}}}function A(e,t){s.setAttributes({[e]:t})}function w(e){s.setAttributes({image_id:e.id?e.id:0});s.setAttributes({image_id_url:e.url?e.url:""})}var j=[];var C=[];var x=[];var I={};var P=false;var S=[];var E=it(o);s.attributes.ic_context_id=ic_blocks_js_global.context.id;s.attributes.ic_context_post_type=ic_blocks_js_global.context.type;var N=De(Le,{key:ot+"-server-side-renderer",block:Qe,attributes:s.attributes});var O=N;if(o.title!==undefined){var T=o.title;C.push(De(qe,{label:ic_blocks_js_global.strings.select_title,value:T,key:ot+"-title",type:"text",onChange:t}))}if(o.shortcode_support!==undefined){var B=o.shortcode_support;C.push(De(Ve,{label:ic_blocks_js_global.strings.select_shortcode_support,value:"1",key:ot+"-shortcode-support",checked:B,type:"checkbox",onChange:r}))}if(o.dropdown!==undefined){var R=false;if(o.dropdown){R=true}C.push(De(Ve,{label:ic_blocks_js_global.strings.select_dropdown,value:"1",key:ot+"-dropdown",checked:R,type:"checkbox",onChange:a}))}if(o.count!==undefined){var Q=false;if(o.count){Q=true}C.push(De(Ve,{label:ic_blocks_js_global.strings.select_count,value:"1",key:ot+"-count",checked:Q,type:"checkbox",onChange:l}))}if(o.hierarchical!==undefined){var F=false;if(o.hierarchical){F=true}C.push(De(Ve,{label:ic_blocks_js_global.strings.select_hierarchical,value:"1",key:ot+"-hierarchical",checked:F,type:"checkbox",onChange:c}))}if(o.category!==undefined||o.selectedCategory!==undefined){var L=ct(o);var M=[];var D=E.categories;var z=E.selected_categories;var U=[];if(D){if(z){z.forEach(e=>{if(e.value!==undefined){U.push(parseInt(e.value,10));if(e.value!==0){M.push({value:parseInt(e.value,10),label:Me(e.label)})}}else{U.push(parseInt(e.id,10));if(e.id!==0){M.push({value:parseInt(e.id,10),label:Me(e.name)+" ("+e.count+")"})}}})}D.forEach(e=>{if(!U.includes(parseInt(e.id,10))){M.push({value:parseInt(e.id,10),label:Me(e.name)+" ("+e.count+")"})}})}var q="";var G=[];var H=[];var J="";if(o.categorySearch!==undefined){J=o.categorySearch;G.push(De(We,{label:ic_blocks_js_global.strings.search_category,value:J,type:"string",key:ot+"-search-category",placeholder:ic_blocks_js_global.strings.category_search_placeholder,onChange:k}));M.forEach(t=>{H.push(De($e,{key:ot+"-checkbox-row-category-"+t.value},De(Ve,{label:t.label,checked:U.includes(t.value),value:t.value,key:ot+"-checkbox-category-"+t.value,onChange:function(e){d(e,t.value,t.label)}})))})}else{H.push(De($e,{key:ot+"-category-select-panel-row"},De(Ue,{multiple:"multiple",label:"",key:ot+"-category-select",value:L,options:M,onChange:d})))}if(M.length===0){if(E.ready){if(J){G.push(De(Je,{key:ot+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword."))}}else{H.push(De(He,{key:ot+"category-selector-loading"}))}}var K=De(Ze,{title:ic_blocks_js_global.strings.select_categories,key:ot+"-category-select-panel-body",className:"ic-panel-body",initialOpen:L},H);if(H.length===0){K=""}x.push(K);var V=ic_blocks_js_global.strings.choose_categories;if(o.selectedProduct!==undefined){V=ic_blocks_js_global.strings.by_category}var W="ic-panel-body";if(!J&&(M.length<5||M.length===0)){W="ic-hidden-panel-body"}if(G.length){q=De(Ze,{title:ic_blocks_js_global.strings.search_category,key:ot+"-search-category-panel-body",className:W,initialOpen:true},G)}var X=De(Ye,{header:V,key:ot+"-main-panel"},q,K);if(L.length===0){if(S.length===0){P=true}}else{P=false}S.push(X)}if(o.orderby!==undefined){var Y=o.orderby;var Z=ic_blocks_js_global.category_orderby_options;C.push(De(Ue,{label:ic_blocks_js_global.strings.select_orderby,value:Y,key:ot+"-select-orderby",type:"dropdown",options:Z,onChange:u}))}if(o.order!==undefined){var $=o.order;var ee=ic_blocks_js_global.order_options;C.push(De(Ue,{label:ic_blocks_js_global.strings.select_order,value:$,key:ot+"-select-order",type:"dropdown",options:ee,onChange:p}))}if(o.archive_template!==undefined){var te=o.archive_template;var re=ic_blocks_js_global.template_options;C.push(De(Ue,{label:ic_blocks_js_global.strings.select_template,value:te,key:ot+"-select-template",type:"dropdown",options:re,onChange:f}))}if(o.per_row!==undefined){var ae=o.per_row;C.push(De(qe,{label:ic_blocks_js_global.strings.select_perrow,value:ae,key:ot+"-select-per-row",type:"number",onChange:g}))}if(o.products_limit!==undefined){var le=o.products_limit;C.push(De(qe,{label:ic_blocks_js_global.strings.select_limit,value:le,key:ot+"-select-products-limit",type:"number",onChange:_}))}if(o.no_add_to_cart!==undefined){var se=o.no_add_to_cart;if(ic_blocks_js_global.price_add_cart_added==="1"){C.push(De($e,{key:ot+"-panel-body-row-noaddcart"},De(Ve,{label:ic_blocks_js_global.strings.disable_add_cart,checked:se,onChange:b})))}}if(e!==undefined){for(const[Pe,Se]of Object.entries(e)){if(o[Pe]!==undefined){var oe=typeof o[Pe];if(oe==="boolean"){C.push(De($e,{key:ot+"-panel-body-row-"+Pe},De(Ve,{label:Se,checked:o[Pe],onChange:function(e){A(Pe,e)}})))}else if(oe==="string"){C.push(De(qe,{label:Se,value:o[Pe],key:ot+"-"+Pe,type:"text",onChange:function(e){A(Pe,e)}}))}}}}if(o.alignment!==undefined){var ie=o.alignment;j.push(De(et,{value:ie,key:ot+"-alignment",onChange:y}));I.textAlign=ie}if(o.productSearch!==undefined&&o.selectedProduct!==undefined){var ne=o.productSearch;var ce=nt(o);var de=[];st=[];var ue=[];var pe=[];if(Array.isArray(ce)&&ce.length!==0||!Array.isArray(ce)&&ce){ue=E.selected_products;if(ue){if(Array.isArray(ue)){ue.forEach(e=>{if(e.value!==undefined){pe.push(parseInt(e.value,10));st.push({value:parseInt(e.value,10),label:Me(e.label)})}else{pe.push(parseInt(e.id,10));st.push({value:parseInt(e.id,10),label:Me(e.title.rendered)})}})}else{pe.push(parseInt(ue,10));st.push({value:parseInt(ue,10),label:"Loading..."})}}}de=E.products;if(de){de.forEach(e=>{if(!pe.includes(parseInt(e.id,10))){st.push({value:parseInt(e.id,10),label:Me(e.title.rendered)})}})}var fe=[De($e,{key:ot+"-panel-body-row-product-search"},De(We,{label:ic_blocks_js_global.strings.search_product,value:ne,type:"string",key:ot+"-search-product",className:"ic-search-control",placeholder:ic_blocks_js_global.strings.search_placeholder,onChange:v}))];var ge=[];var _e=[];var be=[];var he=[];var ye=[];if(Array.isArray(ce)){st.forEach(t=>{be.push(De($e,{key:ot+"-checkbox-row-product-"+t.value},De(Ve,{label:t.label,checked:pe.includes(t.value),value:t.value,key:ot+"-checkbox-product-"+t.value,onChange:function(e){h(e,t.value,t.label)}})))})}else{be.push(De(Ge,{label:"",selected:ce,key:ot+"-product",onChange:h,options:st}));if(o.productFromContext!==undefined){const Ee=o.productFromContext?ic_blocks_js_global.strings.context_enabled_help:ic_blocks_js_global.strings.context_disabled_help;const Ne=De(Ze,{title:"",key:ot+"select-context-product-panel-body",className:"ic-panel-body",initialOpen:true},De($e,{key:ot+"-panel-body-row-product-search-notice"},De(Ke,{label:ic_blocks_js_global.strings.get_product_from_context,checked:o.productFromContext,key:ot+"-product-from-context",help:Ee,onChange:m})));if(o.productFromContext){he.push(Ne);ye.push(Ne)}else{ge.push(Ne);_e.push(Ne)}}}var ve=ic_blocks_js_global.strings.select_product;if(o.category!==undefined){ve=ic_blocks_js_global.strings.by_product}else{const Oe=Fe.getBlockType(s.name);const Te=Oe.title;ve=Te+" - "+ve}var ke="ic-panel-body";var me=0;if(ue){me+=ue.length}if(de){me+=de.length}if(!ne&&(me<10||me===0)){ke="ic-hidden-panel-body"}if(de===null||de.length===0){if(E.ready){if(ne){fe.push(De($e,{key:ot+"-panel-body-row-product-search-notice"},De(Je,{key:ot+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword.")))}}else{be.push(De(He,{key:ot+"product-selector-loading"}))}}ge.push(De(Ze,{title:ic_blocks_js_global.strings.search_product,key:ot+"-search-products-panel-body",className:ke,initialOpen:true},fe));ge.push(De(Ze,{title:ic_blocks_js_global.strings.select_product,key:ot+"select-product-panel-body",className:"ic-panel-body",initialOpen:true},be));if(he.length){ge=he}var Ae=De(Ye,{header:ve,key:ot+"-search-products-block-panel"},ge);_e.push(fe);_e.push(be);if(ye.length){_e=ye}x.push(De(Ze,{title:ic_blocks_js_global.strings.select_product,key:ot+"-side-search-products-panel-body",className:"ic-panel-body",initialOpen:false},_e));if(Array.isArray(ce)&&ce.length===0){if(S.length===0){P=true}}else{P=false}S.push(Ae)}if(o.image_id!==undefined){var we=[];const Be=window.wp.data.useSelect(e=>{const t=o.image_id&&e("core").getMedia(o.image_id);return t&&t.media_details.sizes.medium.source_url},[o.image_id]);const Re=!!Be&&De("img",{src:Be});we.push(De(Xe,{key:ot+"image-id-selector",accept:"image/*",allowedTypes:["image"],multiple:false,onSelect:w,handleUpload:true,mediaPreview:Re}));S.push(De(Ze,{title:ic_blocks_js_global.strings.select_product,key:ot+"select-product-panel-body",className:"ic-panel-body",initialOpen:true},De($e,{key:ot+"-panel-body-row-image_id"},we)))}if(S.length!==0){j.push(De(tt,{icon:"edit",key:ot+"-edit-button",title:ic_blocks_js_global.strings.edit_block,onClick:()=>n(!i),isActive:i||P}))}var je=[De(rt,{key:ot+"-controls"},j)];var Ce=[];if(C.length){Ce.push(De(Ze,{title:ic_blocks_js_global.strings.options,key:ot+"-main-panel-body",className:"main-panel-body",initialOpen:true},C))}if(x.length){Ce.push(x)}if(Ce.length){je.push(De(ze,{key:"ic-price-field-table-block-controls"},Ce))}if(i||P){O=S;P=true;if(!i){n(true)}}var xe="ic-block-output";if(P){xe+="-edit"}var Ie={key:ot+"-div",className:xe};if(!i){Ie.style=I;if(S.length!==0&&j.length<=1){Ie.onClick=()=>n(true)}}je.push(De("div",at(Ie),O));return je},save:function(){return null}});function it(_){const e=window.wp.data.useSelect(e=>{const t=e("core");var r={};r.ready=true;if(_.selectedCategory!==undefined){var a=ct(_);var l={per_page:-1,_fields:"id,name,count",orderby:"term_group"};if(_.categorySearch!==undefined){var s=_.categorySearch;l.per_page=10;if(s){l.search=s;l.per_page=-1}}if(a.length!==0){var o=true;var i={per_page:-1,_fields:"id,name,count",orderby:"include",include:a.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{o=false;return parseInt(e,10)}})};r.selected_categories=t.getEntityRecords("taxonomy","al_product-cat",i);if(r.selected_categories===null&&o){r.selected_categories=a}else{}if(r.selected_categories===null){r.ready=false}else if(r.selected_categories.length>=l.per_page&&l.per_page>0){l.per_page=l.per_page+r.selected_categories.length}}r.categories=t.getEntityRecords("taxonomy","al_product-cat",l);if(r.categories===null){r.ready=false}}if(_.productSearch!==undefined&&_.selectedProduct!==undefined){var n=nt(_);var c=_.productSearch;var d={per_page:10,_fields:"id,title"};if(Array.isArray(n)&&n.length!==0||!Array.isArray(n)&&n){var u=true;var p={per_page:-1,_fields:"id,title",orderby:"include",include:Array.isArray(n)?n.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{u=false;return parseInt(e,10)}}):n};r.selected_products=t.getEntityRecords("postType","al_product",p);if(r.selected_products===null&&u){r.selected_products=n}else{}if(r.selected_products===null){r.ready=false}else if(r.selected_products.length>=d.per_page){d.per_page=d.per_page+r.selected_products.length}}if(c){d.search=c;d.per_page=100}r.products=t.getEntityRecords("postType","al_product",d);if(r.products===null){r.ready=false}}if(!r.ready){for(const[f,g]of Object.entries(r)){r[f]=null}}return r});return e}function nt(e){var t=e.selectedProduct;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.product.length){t=e.product.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedProduct,10)}return t}function ct(e){var t=e.selectedCategory;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.category.length){t=e.category.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedCategory,10)}return t}}jQuery(window).on("load",function(){setTimeout(ic_block_meta_values_dynamic,1e3)});function ic_block_meta_values_dynamic(){jQuery(".ic-product-meta-field").each(function(){jQuery(this).on("change",function(){var e=jQuery(this).attr("name");var t={};t[e]=jQuery(this).val();wp.data.dispatch("core/editor").editPost({meta:t})})});wp.media.featuredImage.frame().on("select",function(){var e=wp.media.featuredImage.get();var t="_thumbnail_id";var r={};r[t]=e;wp.data.dispatch("core/editor").editPost({meta:r})});jQuery("#remove-post-thumbnail").on("click",function(){var e="_thumbnail_id";var t={};t[e]="";wp.data.dispatch("core/editor").editPost({meta:t})})}